

mutation SignIn($email: String!, $password: String!) {
  SignIn(Email: $email, Password: $password) {
    Token
  }
}

mutation SignUp($login: String!, $password: String!, $email: String!) {
  SignUp(Login: $login, Password: $password, Email: $email) {
    Token
  }
}

query CurrentUser {
  CurrentUser {
    ...UserAttrs
  }
}

mutation UpdateCurrentUser($avatar: String) {
  UpdateCurrentUser(Avatar: $avatar) {
    ...UserAttrs
  }
}

fragment UserAttrs on User {
    Id
    Login
    Avatar
    Email
}

query GetPaginatedRooms($page: Int, $pageSize: Int) {
  GetPaginatedRooms(Page: $page, PageSize: $pageSize) {
    Entries {
      ...RoomAttrs
    }
    TotalPages
  }
}

fragment RoomAttrs on Room {
    MediaInfo {
      ...MediaInfoAttrs
    }
    Id
    Likes
    Private
    Image
    Key
    Name
    Owner {
      Id
    }
}

query GetRoomPlaylist($roomId: String!) {
  GetRoomPlaylist(RoomId: $roomId) {
    ...PlaylistRowAttrs
  }
}

mutation DeletePlaylistSource($playlistRowId: String!, $roomId: String!) {
  DeletePlaylistSource(PlaylistRowId: $playlistRowId, RoomId: $roomId) {
    ...PlaylistRowAttrs
  }
}

mutation MovePlaylistSourcePosition($position: Int!, $roomId: String!, $playlistRowId: String!) {
  MovePlaylistSourcePosition(Position: $position, RoomId: $roomId, PlaylistRowId: $playlistRowId) {
    ...PlaylistRowAttrs
  }
}

query GetRoomByKey($key: String!) {
  GetRoomByKey(Key: $key) {
    ...RoomAttrs
  }
}

mutation CreateRoom($name: String!, $type: RoomType, $image: String, $private: Boolean) {
  CreateRoom(Name: $name, Type: $type, Image: $image, Private: $private) {
    ...RoomAttrs
  }
}

mutation UpdateRoom($roomId: String!, $name: String!, $private: Boolean, $type: RoomType, $image: String) {
  UpdateRoom(RoomId: $roomId, Name: $name, Private: $private, Type: $type, Image: $image) {
    ...RoomAttrs
  }
}

mutation DeleteRoom($roomId: String!) {
  DeleteRoom(RoomId: $roomId) {
    Id
  }
}

fragment PlaylistRowAttrs on PlaylistRow {
  Id
  Index
  Source {
    ...SourceAttrs
  }
}

fragment MediaInfoAttrs on MediaInfo {
  CurrentTimeSeconds
  DurationSeconds
  Source {
    ...SourceAttrs
  }
}


fragment SourceAttrs on Source {
    Id
    Cover
    Name
    Url
}

mutation AddPlaylistSource($roomId: String!, $url: String!) {
  AddPlaylistSource(RoomId: $roomId, Url: $url) {
    ...PlaylistRowAttrs
  }
}

mutation RoomAction($action: MediaAction, $arg: String, $roomId: String) {
  RoomAction(Action: $action, Arg: $arg, RoomId: $roomId)
}

subscription SubscribeChat($roomId: String!) {
  SubscribeChat(RoomId: $roomId) {
    Message {
       ...MessageAttrs
    }
    RoomReaction
  }
}

mutation SendMessage($roomId: String!, $message: MessageInput!) {
  SendMessage(RoomId: $roomId, Message: $message)
}

mutation HideMessage($roomId: String!, $messageId: String!) {
  HideMessage(RoomId: $roomId, MessageId: $messageId)
}

mutation SendReaction($messageId: String!, $reaction: String!, $roomId: String!) {
  SendReaction(MessageId: $messageId, Reaction: $reaction, RoomId: $roomId)
}

mutation SendRoomReaction($roomId: String!) {
  SendRoomReaction(RoomId: $roomId)
}

query GetMessages($roomId: String!) {
  GetMessages(RoomId: $roomId) {
    ...MessageAttrs
  }
}

fragment MessageAttrs on Message {
  From {
    ...MessageUserAttrs
  }
  Id
  Reactions {
    ...ReactionMessageAttrs
  }
  ReplyMessage {
    ...ReplyMessageAttrs
  }
  Text
  Type
}

fragment ReactionMessageAttrs on ReactionMessage {
 Reaction
    From {
      Id
    }
}

fragment ReplyMessageAttrs on ReplyMessage {
  From {
    ...MessageUserAttrs
  }
  Id
  Text
  Type
}

fragment MessageUserAttrs on User {
    Avatar
    Id
    Login
}

subscription SubscribeMediaInfo($roomId: String) {
  SubscribeMediaInfo(RoomId: $roomId) {
    CurrentTimeSeconds
    DurationSeconds
    MediaAction
    Source {
      ...SourceAttrs
    }
  }
}
